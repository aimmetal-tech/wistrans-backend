# æ™ºæ…§è¯‘-åç«¯ (Wistrans Backend)

æ™ºæ…§è¯‘æ˜¯ä¸€ä¸ªåŸºäºå¤§è¯­è¨€æ¨¡å‹çš„ç½‘é¡µç¿»è¯‘æœåŠ¡ï¼Œæ”¯æŒå¤šç§ä¸»æµ AI æ¨¡å‹ã€‚

## åŠŸèƒ½ç‰¹æ€§

- æ”¯æŒå¤šç§å¤§è¯­è¨€æ¨¡å‹:
  - DeepSeek (deepseek-chat)
  - é˜¿é‡Œäº‘ç™¾ç‚¼ (qwen-turbo-latest)
  - OpenAI (gpt-4o)
  - Moonshot Kimi (kimi-k2-0711-preview)
- æ‰¹é‡æ–‡æœ¬ç‰‡æ®µç¿»è¯‘
- å¯è‡ªå®šä¹‰ç¿»è¯‘é£æ ¼
- RESTful API æ¥å£

## æŠ€æœ¯æ ˆ

- Python 3.8+
- FastAPI (Web æ¡†æ¶)
- Pydantic (æ•°æ®éªŒè¯)
- HTTPX (å¼‚æ­¥ HTTP å®¢æˆ·ç«¯)
- Uvicorn (ASGI æœåŠ¡å™¨)

## å®‰è£…ä¸é…ç½®

### 1. å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

### 2. é…ç½®ç¯å¢ƒå˜é‡

å¤åˆ¶ .env.example æ–‡ä»¶ä¸º `.env` å¹¶å¡«å…¥å„å¹³å°çš„ API å¯†é’¥:

```bash
cp .env.example .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œå¡«å…¥ä»å„ AI å¹³å°è·å–çš„ API å¯†é’¥ã€‚

### 3. å¯åŠ¨æœåŠ¡

```bash
python main.py
```

æœåŠ¡é»˜è®¤è¿è¡Œåœ¨ `http://localhost:8000`

## API æ¥å£

### ç¿»è¯‘æ¥å£

```
POST /translate
```

#### è¯·æ±‚å‚æ•°

| å‚æ•°å     | ç±»å‹   | å¿…å¡« | è¯´æ˜                             |
| ---------- | ------ | ---- | -------------------------------- |
| target     | string | æ˜¯   | ç›®æ ‡è¯­è¨€ï¼Œå¦‚ "en" è¡¨ç¤ºç¿»è¯‘ä¸ºè‹±è¯­ |
| segments   | array  | æ˜¯   | è¦ç¿»è¯‘çš„æ–‡æœ¬ç‰‡æ®µåˆ—è¡¨             |
| extra_args | object | å¦   | ç¿»è¯‘çš„é¢å¤–è¦æ±‚ï¼Œå¦‚é£æ ¼ç­‰         |

#### segments å‚æ•°è¯´æ˜

| å‚æ•°å | ç±»å‹   | å¿…å¡« | è¯´æ˜                                        |
| ------ | ------ | ---- | ------------------------------------------- |
| id     | string | æ˜¯   | ç‰‡æ®µ IDï¼Œç”¨äºæ ‡è¯†ç‰‡æ®µä»¥ä¾¿è¿”å›åˆ°å‰ç«¯ç›¸åº”ä½ç½® |
| text   | string | æ˜¯   | è¦ç¿»è¯‘çš„æ–‡æœ¬å†…å®¹                            |
| model  | string | å¦   | æ¨¡å‹åç§°ï¼Œé»˜è®¤ä¸º "deepseek-chat"            |

#### è¯·æ±‚ç¤ºä¾‹

```json
{
  "target": "en",
  "segments": [
    {
      "id": "segment1",
      "text": "è¿™æ˜¯è¦ç¿»è¯‘çš„æ–‡æœ¬"
    },
    {
      "id": "segment2",
      "text": "è¿™æ˜¯å¦ä¸€æ®µè¦ç¿»è¯‘çš„æ–‡æœ¬",
      "model": "gpt-4o"
    }
  ],
  "extra_args": {
    "style": "æ¯å¥å¼€å¤´åŠ ä¸Š`ğŸ˜­`ï¼Œåœ¨æ¯å¥ç¿»è¯‘ååŠ ä¸Š`ğŸ˜Š`"
  }
}
```

#### å“åº”ç¤ºä¾‹

```json
{
  "translated": "en",
  "segments": [
    {
      "id": "segment1",
      "text": "ğŸ˜­This is the text to be translatedğŸ˜Š"
    },
    {
      "id": "segment2",
      "text": "ğŸ˜­This is another text to be translatedğŸ˜Š"
    }
  ]
}
```

## æ”¯æŒçš„æ¨¡å‹

| æ¨¡å‹åç§°             | é»˜è®¤å¯ç”¨ | æä¾›å•†     |
| -------------------- | -------- | ---------- |
| deepseek-chat        | æ˜¯       | æ·±åº¦æ±‚ç´¢   |
| qwen-turbo-latest    | å¦       | é˜¿é‡Œäº‘ç™¾ç‚¼ |
| gpt-4o               | å¦       | OpenAI     |
| kimi-k2-0711-preview | å¦       | æœˆä¹‹æš—é¢   |

## é¡¹ç›®ç»“æ„

```
.
â”œâ”€â”€ main.py              # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ schemas.py           # æ•°æ®æ¨¡å‹å®šä¹‰
â”œâ”€â”€ model_service.py     # æ¨¡å‹æœåŠ¡å®ç°
â”œâ”€â”€ requirements.txt     # é¡¹ç›®ä¾èµ–
â”œâ”€â”€ .env.example         # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”œâ”€â”€ .env                 # ç¯å¢ƒå˜é‡é…ç½®ï¼ˆéœ€æ‰‹åŠ¨åˆ›å»ºï¼‰
â”œâ”€â”€ README.md            # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â””â”€â”€ docs/
    â””â”€â”€ api.md           # APIæ–‡æ¡£
```
